{% extends 'base.html' %}
{% block subtitle %}<h3 class="wow fadeInDown" data-wow-duration="1s" data-wow-delay=".1s" style="visibility: visible; animation-duration: 1s; animation-delay: 0.1s;">미팅 만들기</h3>{% endblock %}
{% block content_container %}
    <div>
        <h4 class="wow fadeInDown" data-wow-duration="1s" data-wow-delay=".1s" style="visibility: visible; animation-duration: 1s; animation-delay: 0.1s;">수업에 필요한 정보들을 추가해주세요!</h4>
        <form class="form-contact contact_form" action="." method="post">
            {% csrf_token %}
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label for="id_title">Title:</label>
                        <input class="form-control valid" name="title" maxlength="30" required id="id_title" value="Untitled" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter the title'" placeholder="Enter the title">
                    </div>
                    <div class="form-group">
                        <label for="id_description">Description:</label>
                        <textarea class="form-control w-100" name="description" required id="id_description" cols="40" rows="10" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter Message'" placeholder=" Name"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="id_members">Members:</label>
                        <select class="form-control-static" name="members" required id="id_members" multiple>
                            {% for member in form.members %}
                                {{ member }}
                            {% endfor %}
                        </select>
                        <button type="submit" class="genric-btn info circle">확인</button>

                    </div>

                </div>
                <div class="col-6 row">
                    <form id="add_member" method="post">
                        {% csrf_token %}
                        <label for="id_member">Member Search:</label>
                        <input class="form-control valid" name="id_member" maxlength="30" required id="id_member" value="Member Search" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter the member'" placeholder="Enter the member">
                    </form>
                    <div id="done_member">

                    </div>
                </div>
            </div>
        </form>
    </div>



    {% block extra_js %}
        <script type="text/javascript">
            function newAlert (name){
                alert(name);
                return false;
            }
            $(document).ready(function () {
                $('#id_member').keydown(function (key) {
                    if(key.keyCode == 13){
                        var username = $('#id_member').val()
                        var queryString = $('#add_member').serialize();

                        $.ajax({
                            type: 'POST',
                            url: '{% url 'meeting:member_update' object.pk %}',
                            dataType: 'json',
                            data: queryString,
                            success: function (res) {
                                if(res['message'])
                                    newAlert(res['error']);
                                else {
                                    newAlert(username);
                                    $('#done_member').html(username)
                                }
                            },
                            error: function (error) {
                                newAlert('존재 하지 않는 아이디입니다.');
                            }
                        });
                    }
                })
            })
        </script>
    {% endblock %}
{% endblock %}
